<!DOCTYPE html>
<html lang="en">
<head>

    <script async src="https://www.googletagmanager.com/gtag/js?id=G-7F1WP8JXBL"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-7F1WP8JXBL', {
          page_location: 'https://velvelt.onrender.com/?gclid=Cj0KCQjw2uiwBhCXARIsACMvIU0FJgVvVA7dG6hSAWQ1JZR32KJvUzHssC4gqiH5_789defABC123dummy&utm_source=google&utm_medium=cpc&utm_campaign=spring_sale&utm_id=promo_2024&utm_term=test+keyword&utm_content=textlink_v2', // Fake L1 URL
          page_title: 'Jobs Next Door - Career Partner in Recruitment'
      });
    </script>

    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}">
    <!-- Lucide Icons via CDN -->
    <script src="https://unpkg.com/lucide@latest"></script>
</head>
<body>
    <!-- Toast Notification -->
    <div id="toast" class="toast"></div>

    <div class="page-wrapper">
        <!-- Header -->

        <!-- Hero Section -->
        <section class="hero">
            <div class="hero-overlay">
                <img src="https://images.unsplash.com/photo-1683770997177-0603bd44d070?crop=entropy&cs=tinysrgb&fit=max&fm=jpg&ixid=M3w3Nzg4Nzd8MHwxfHNlYXJjaHwxfHxwcm9mZXNzaW9uYWwlMjBvZmZpY2UlMjB0ZWFtfGVufDF8fHx8MTc2MTA1MTgzMnww&ixlib=rb-4.1.0&q=80&w=1080"
                     alt="Professional team"
                     class="hero-bg-image">
            </div>

            <div class="container hero-content">
                <div class="hero-text">
                    <h2 class="hero-title">Your Career Partner in Recruitment</h2>
                    <p class="hero-description">
                        Jobs Next Door is a leading recruitment marketing company specializing in connecting exceptional talent with top-tier companies. We bridge the gap between corporates and candidates across white-collar, grey-collar, and blue-collar industries.
                    </p>

                    <div class="stats-grid">
                        <div class="stat-item">
                            <div class="stat-icon stat-icon-blue">
                                <i data-lucide="users"></i>
                            </div>
                            <div>
                                <div class="stat-number">10,000+</div>
                                <div class="stat-label">Candidates Placed</div>
                            </div>
                        </div>

                        <div class="stat-item">
                            <div class="stat-icon stat-icon-blue">
                                <i data-lucide="building-2"></i>
                            </div>
                            <div>
                                <div class="stat-number">500+</div>
                                <div class="stat-label">Partner Companies</div>
                            </div>
                        </div>

                        <div class="stat-item">
                            <div class="stat-icon stat-icon-blue">
                                <i data-lucide="award"></i>
                            </div>
                            <div>
                                <div class="stat-number">15+ Years</div>
                                <div class="stat-label">Industry Experience</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- About Section -->
        <section class="about-section">
            <div class="container">
                <div class="section-header">
                    <h2 class="section-title">Why Choose Jobs Next Door?</h2>
                    <p class="section-description">
                        We don't just fill positions – we build careers. As a recruitment marketing company, we act as the trusted middle-man between leading corporates and skilled professionals, ensuring the perfect match for both parties.
                    </p>
                </div>

                <div class="features-grid">
                    <div class="feature-card">
                        <div class="feature-icon feature-icon-blue">
                            <i data-lucide="briefcase"></i>
                        </div>
                        <h3 class="feature-title">White-Collar Roles</h3>
                        <p class="feature-description">
                            Executive positions, management roles, and professional services across finance, technology, healthcare, and more.
                        </p>
                    </div>

                    <div class="feature-card">
                        <div class="feature-icon feature-icon-green">
                            <i data-lucide="users"></i>
                        </div>
                        <h3 class="feature-title">Grey-Collar Roles</h3>
                        <p class="feature-description">
                            Skilled technical positions, IT specialists, healthcare workers, and professionals in hybrid roles.
                        </p>
                    </div>

                    <div class="feature-card">
                        <div class="feature-icon feature-icon-orange">
                            <i data-lucide="building-2"></i>
                        </div>
                        <h3 class="feature-title">Blue-Collar Roles</h3>
                        <p class="feature-description">
                            Manufacturing, construction, logistics, skilled trades, and essential workforce positions.
                        </p>
                    </div>
                </div>
            </div>
        </section>

        <!-- Application Form Section -->
        <section class="form-section">
            <div class="container">
                <div class="form-card">
                    <div class="form-header">
                        <h2 class="form-title">Apply for a Position</h2>
                        <p class="form-description">
                            Fill out the form below to submit your application. We connect talented professionals with leading companies across all industries.
                        </p>
                    </div>

                  <form
    id="jobForm"
    class="application-form"
    action="{{ url_for('index', **query_params) }}"
    method="POST"
    enctype="multipart/form-data">

                        <!-- Personal Information -->
                        <div class="form-section-group">
                            <h3 class="form-section-title">Personal Information</h3>

                            <div class="form-row">
                                <div class="form-group">
                                    <label for="first" class="form-label">First name *</label>
                                    <input
                                        type="text"
                                        id="first"
                                        name="first_name"
                                        class="form-input"
                                        placeholder="First name"
                                        required>
                                </div>

                                <div class="form-group">
                                    <label for="last" class="form-label">Last name *</label>
                                    <input
                                        type="text"
                                        id="last"
                                        name="last_name"
                                        class="form-input"
                                        placeholder="Last name"
                                        required>
                                </div>
                            </div>

                            <div class="form-group">
                                <label for="email" class="form-label">Email *</label>
                                <input
                                    type="email"
                                    id="email"
                                    name="email"
                                    class="form-input"
                                    placeholder="Email"
                                    required>
                            </div>

                            <div class="form-group">
                                <label for="phone" class="form-label">Phone *</label>
                                <input
                                    type="tel"
                                    id="phone"
                                    name="phone"
                                    class="form-input"
                                    placeholder="Phone"
                                    required>
                            </div>
                        </div>

                        <!-- Location Information -->
                        <div class="form-section-group">
                            <h3 class="form-section-title">Location</h3>

                            <div class="form-row">
                                <div class="form-group">
                                    <label for="country" class="form-label">Country *</label>
                                    <select id="country" name="country" class="form-select" required>
                                        <option value="">Choose country</option>
                                        <option>United States</option>
                                        <option>India</option>
                                        <option>United Kingdom</option>
                                        <option>Australia</option>
                                    </select>
                                </div>

                                <div class="form-group">
                                    <label for="city" class="form-label">City *</label>
                                    <input
                                        type="text"
                                        id="city"
                                        name="city"
                                        class="form-input"
                                        placeholder="City"
                                        required>
                                </div>
                            </div>

                            <div class="form-group">
                                <label for="address" class="form-label">Address *</label>
                                <input
                                    type="text"
                                    id="address"
                                    name="address"
                                    class="form-input"
                                    placeholder="Address"
                                    required>
                            </div>
                        </div>

                        <!-- Position Information -->
                        <div class="form-section-group">
                            <h3 class="form-section-title">Position Details</h3>

                            <div class="form-group">
                                <label for="position" class="form-label">Position applying for *</label>
                                <select id="position" name="position" class="form-select" required>
                                    <option value="">Choose position</option>
                                    <option>Full Stack Engineer</option>
                                    <option>Product Manager</option>
                                    <option>UI/UX Designer</option>
                                </select>
                            </div>

                            <div class="form-group">
                                <label for="info" class="form-label">Additional information</label>
                                <textarea
                                    id="info"
                                    name="additional_info"
                                    class="form-textarea"
                                    placeholder="Additional info"
                                    rows="4"></textarea>
                            </div>

                            <div class="form-group">
                                <label for="cv" class="form-label">Resume / CV *</label>
                                <input
                                    type="file"
                                    id="cv"
                                    name="resume"
                                    accept=".pdf,.doc,.docx"
                                    class="file-input"
                                    required>
                                <label for="cv" class="file-label" id="fileLabel">
                                    <i data-lucide="upload" class="file-icon"></i>
                                    <span id="fileName">Click to upload your resume (PDF, DOC, DOCX)</span>
                                </label>
                            </div>
                        </div>

                        <!-- Terms and Conditions Section -->
<div class="terms-checkbox-group">
    <div class="terms-checkbox-item">
        <input type="checkbox" id="terms1" name="terms1" class="terms-checkbox" required>
        <label for="terms1" class="terms-label">
            I agree to the
            <!-- ✅ UPDATE: Redirect to L1's terms page with parameters -->
            <a href="https://velvelt.onrender.com/terms/data-collection?{{ request.query_string.decode() if request.query_string else '' }}" class="terms-link" target="_blank" id="termsLink1">
                Data Collection and Privacy Policy
            </a>
        </label>
    </div>

    <div class="terms-checkbox-item">
        <input type="checkbox" id="terms2" name="terms2" class="terms-checkbox" required>
        <label for="terms2" class="terms-label">
            I consent to the
            <!-- ✅ UPDATE: Redirect to L1's terms page with parameters -->
            <a href="https://velvelt.onrender.com/terms/communication?{{ request.query_string.decode() if request.query_string else '' }}" class="terms-link" target="_blank" id="termsLink2">
                Communication and Contact Terms
            </a>
        </label>
    </div>

    <div class="terms-checkbox-item">
        <input type="checkbox" id="terms3" name="terms3" class="terms-checkbox" required>
        <label for="terms3" class="terms-label">
            I accept the
            <!-- ✅ UPDATE: Redirect to L1's terms page with parameters -->
            <a href="https://velvelt.onrender.com/terms/recruitment?{{ request.query_string.decode() if request.query_string else '' }}" class="terms-link" target="_blank" id="termsLink3">
                Recruitment Process and Job Matching Terms
            </a>
        </label>
    </div>
</div>
                        <!-- Form Actions -->
                        <div class="form-actions">
                            <button type="button" class="btn reset" id="resetBtn">Reset</button>
                            <button type="submit" class="btn send" id="submitBtn">
                                <span id="submitText">Send</span>
                            </button>
                        </div>
                    </form>
                </div>
            </div>
        </section>

        <!-- Footer -->
        <footer class="footer">
            <div class="container">
                <div class="footer-grid">
                    <div class="footer-column">
                        <div class="footer-brand">
                            <i data-lucide="briefcase" class="footer-icon"></i>
                            <span class="footer-brand-text">Jobs Next Door</span>
                        </div>
                        <p class="footer-text">
                            Your trusted partner in recruitment marketing, connecting talent with opportunity since 2010.
                        </p>
                    </div>

                    <div class="footer-column">
                        <h4 class="footer-heading">Contact Us</h4>
                        <div class="footer-links">
                            <p>Email: careers@jobsnextdoor.com</p>
                            <p>Phone: 1-800-JOBS-NOW</p>
                            <p>Available: Mon-Fri, 9AM-6PM</p>
                        </div>
                    </div>

                    <div class="footer-column">
                        <h4 class="footer-heading">Industries We Serve</h4>
                        <ul class="footer-links">
                            <li>Technology & IT</li>
                            <li>Healthcare & Pharmaceuticals</li>
                            <li>Manufacturing & Engineering</li>
                            <li>Finance & Professional Services</li>
                            <li>Construction & Skilled Trades</li>
                        </ul>
                    </div>
                </div>

                <div class="footer-bottom">
                    <p>&copy; 2025 Jobs Next Door. All rights reserved. We are a recruitment marketing company and do not directly employ candidates.</p>
                </div>
            </div>
        </footer>
    </div>

    <script src="{{ url_for('static', filename='script.js') }}"></script>
    <script>
        // Initialize Lucide icons
        lucide.createIcons();

        // ✅ CLIENT-SIDE PARAMETER PRESERVATION
        document.addEventListener('DOMContentLoaded', function() {
            // Function to preserve campaign parameters
            function preserveCampaignParams() {
                const urlParams = new URLSearchParams(window.location.search);
                const campaignParams = {};

                for (const [key, value] of urlParams) {
                    if (key.includes('utm_') || key === 'gclid' || key === 'fbclid') {
                        campaignParams[key] = value;
                    }
                }

                return campaignParams;
            }

            // Function to add parameters to a URL
            function addParamsToUrl(baseUrl) {
                const params = preserveCampaignParams();
                if (Object.keys(params).length === 0) {
                    return baseUrl;
                }

                const urlObj = new URL(baseUrl, window.location.origin);
                Object.entries(params).forEach(([key, value]) => {
                    urlObj.searchParams.set(key, value);
                });
                return urlObj.toString();
            }

            // Function to get L1 attribution URL
            function getL1AttributionUrl(l1Path) {
                const l1BaseUrl = `https://velvelt.onrender.com/${l1Path}`;
                return addParamsToUrl(l1BaseUrl);
            }

            // Log parameters for debugging
            const params = preserveCampaignParams();
            if (Object.keys(params).length > 0) {
                console.log('L2 Index - Preserved parameters:', params);
            }

            // ✅ UPDATE GA4 PAGE VIEW WITH L1 ATTRIBUTION
            const l1PageUrl = getL1AttributionUrl('/');
            gtag('event', 'page_view', {
                'page_title': 'Jobs Next Door - Career Partner in Recruitment',
                'page_location': l1PageUrl,
                'campaign_params': JSON.stringify(params)
            });

            // ✅ Google Analytics event tracking for the Send button
            const submitBtn = document.getElementById('submitBtn');
            submitBtn.addEventListener('click', () => {
                gtag('event', 'submit_application', {
                    'event_category': 'Form',
                    'event_label': 'Job Application Submitted',
                    'value': 1,
                    'page_location': l1PageUrl
                });
            });

            // Optional: Track form reset
            const resetBtn = document.getElementById('resetBtn');
            resetBtn.addEventListener('click', () => {
                gtag('event', 'form_reset', {
                    'event_category': 'Form',
                    'event_label': 'Application Form Reset',
                    'page_location': l1PageUrl
                });
            });

            // ✅ ENHANCED Terms and Conditions GA4 Tracking
            const termsLinks = document.querySelectorAll('.terms-link');
            termsLinks.forEach((link, index) => {
                link.addEventListener('click', (e) => {
                    const termsPath = link.getAttribute('href').split('/').pop();
                    const l1TermsUrl = getL1AttributionUrl(`/terms/${termsPath}`);

                    gtag('event', 'terms_view', {
                        'event_category': 'Terms & Conditions',
                        'event_label': `Viewed ${termsPath} terms`,
                        'link_id': `terms${index + 1}`,
                        'page_location': l1TermsUrl
                    });

                    // Optional: Open in same tab instead of new tab
                    // e.preventDefault();
                    // window.location.href = link.href;
                });
            });

            // ✅ Track terms checkbox interactions
            const termsCheckboxes = document.querySelectorAll('.terms-checkbox');
            termsCheckboxes.forEach((checkbox, index) => {
                checkbox.addEventListener('change', (e) => {
                    const action = e.target.checked ? 'accepted' : 'unchecked';
                    const termsPath = document.querySelector(`#termsLink${index + 1}`).getAttribute('href').split('/').pop();

                    gtag('event', 'terms_interaction', {
                        'event_category': 'Terms & Conditions',
                        'event_label': `${action} ${termsPath}`,
                        'terms_id': `terms${index + 1}`,
                        'page_location': l1PageUrl
                    });
                });
            });

            // ✅ Form validation for terms
            const jobForm = document.getElementById('jobForm');
            jobForm.addEventListener('submit', (e) => {
    const allTermsChecked = Array.from(termsCheckboxes).every(cb => cb.checked);

    if (!allTermsChecked) {
        e.preventDefault();
        showToast('Please accept all terms and conditions', 'error');
        gtag('event', 'form_validation_failed', {
            'event_category': 'Form',
            'event_label': 'Terms not accepted',
            'page_location': l1PageUrl
        });
    } else {
        // Form will submit naturally
        gtag('event', 'submit_application', {
            'event_category': 'Form',
            'event_label': 'Job Application Submitted',
            'value': 1,
            'page_location': l1PageUrl
        });
    }
});

            let maxScroll = 0;
            const pageStartTime = Date.now();

            window.addEventListener('scroll', () => {
                const scrollTop = window.pageYOffset;
                const docHeight = document.documentElement.scrollHeight - window.innerHeight;
                const scrollPercent = (scrollTop / docHeight) * 100;

                if (scrollPercent > maxScroll) {
                    maxScroll = scrollPercent;

                    // Track major scroll milestones
                    const milestones = [25, 50, 75, 90];
                    milestones.forEach(milestone => {
                        if (Math.round(maxScroll) === milestone) {
                            gtag('event', 'page_scroll_depth', {
                                'event_category': 'Engagement',
                                'event_label': `Scrolled ${milestone}%`,
                                'scroll_depth': milestone,
                                'page_location': l1PageUrl
                            });
                        }
                    });
                }
            });

            // Track time on page
            window.addEventListener('beforeunload', () => {
                const timeSpent = Math.round((Date.now() - pageStartTime) / 1000);
                gtag('event', 'page_time_spent', {
                    'event_category': 'Engagement',
                    'event_label': 'Time spent on page',
                    'time_seconds': timeSpent,
                    'scroll_depth': Math.round(maxScroll),
                    'page_location': l1PageUrl
                });
            });
        });
    </script>
</body>
</html>